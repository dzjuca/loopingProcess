clc
clear 
close all

dp = 55e-4; % cm =====> revisar valor
di = 40;    % cm
Ht = 600;   % cm
Gs = 100*(1000/(100^2));   % g/cm2s
n_o = 40;   % mol/s
T = 300;    % K
P = 1.3;    % atm
R = 0.08205746;  % [atm.L/mol.K]
g = 981;    % cm/s2
nd = 20;    % mesh points
nl = 80;    % mesh points
% -------------------------------------------------------------------------
rho_g = 0.0012; % g/cm3
rho_s = 1.0000; % g/cm3
mu_g  = 1.8e-4; % g/cms

% -------------------------------------------------------------------------

q_o = (n_o*R*T/P)*1000;    % cm3/s

% -------------------------------------------------------------------------
A   = pi*(di/2)^2; % cm2

% -------------------------------------------------------------------------
u_0 = q_o/A;       % cm/s

% -------------------------------------------------------------------------
dp_ast = dp*((rho_g*(rho_s - rho_g)*g)/(mu_g^2))^(1/3);
% -------------------------------------------------------------------------

u0_ast = u_0*((rho_g)^2/(mu_g*(rho_s - rho_g)*g))^(1/3);

% -------------------------------------------------------------------------

ut_ast = ((18/dp_ast^2)+(0.591/dp_ast^(1/2)))^(-1);
% -------------------------------------------------------------------------

ut = ut_ast*((mu_g*(rho_s - rho_g)*g)/(rho_g^2))^(1/3);

% -------------------------------------------------------------------------

f_d   = 0.06; 
f_ast = 0.01;
u0_a  = 3;    % s-1

% -------------------------------------------------------------------------
a = u0_a/u_0; % cm-1

% -------------------------------------------------------------------------
f_ex = Gs/(rho_s*(u_0 - ut));

% -------------------------------------------------------------------------

Hl = (1/a)*log((f_d - f_ast)/(f_ex - f_ast));

% -------------------------------------------------------------------------

Hd = Ht - Hl;

% -------------------------------------------------------------------------

fl_med = f_ast + ((f_d - f_ex)/(a*Hl));

% -------------------------------------------------------------------------

Wd = A*rho_s*Hd*f_d;

% -------------------------------------------------------------------------

Wl = A*rho_s*Hl*fl_med;

% -------------------------------------------------------------------------

W = Wd + Wl;

% -------------------------------------------------------------------------
zd = linspace(0,  Hd, nd)';
zl = linspace(Hd, Hd + Hl, nl)';
H  = zl - zd(end);
% -------------------------------------------------------------------------
fl = f_ast + (f_d - f_ast)*exp(-a*H);
fd = zeros(nd, 1);
fd(:,1) = f_d;

% -------------------------------------------------------------------------
hold on
plot(fl, zl, 'r')
plot(fd, zd, 'b')
xlim([0 0.6])
hold off